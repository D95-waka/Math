\input{../article_base.tex}
\title{פתרון מטלה 08 --- תורת ההסתברות (1), 80420}

\DeclareMathOperator{\Supp}{Supp}

\begin{document}
\maketitle
\maketitleprint{}

\question{}
יהי $X$ משתנה מקרי בעל תוחלת, נראה שלכל $c > 0$ מתקיים
\[
	\PP(|X - \EE(X)| \ge c)
	\le \frac{2 \EE(|X|)}{c}
\]
\begin{proof}
	נבחין כי מתקיים
	\[
		\EE(|\EE(X)|)
		= \sum_{s \in \Supp |\EE(X)|} s \PP(|\EE(X)| = s)
		= |\EE(X)| \PP(|\EE(X)| = |\EE(X)|)
		= |\EE(X)|
	\]
	ולכן מאי־שוויון מרקוב
	\[
		\PP(|X - \EE(X)| \ge c)
		\le \frac{\EE(|X - \EE(X)|)}{c}
		\le \frac{\EE(|X| + |\EE(X)|)}{c}
		= \frac{\EE(|X|) + \EE(|\EE(X)|)}{c}
		= \frac{2 \EE(|X|)}{2}
	\]
\end{proof}

\question{}
נבחן מודל לתיאור גודל אוכלוסיית חיידקים במושבה,
בדור 0 יש חיידק בודד, בסוף כל דור על חיידק מתפצל למספר חיידקים המתפלג פואסון עם פרמטר $c$ באופן בלתי־תלוי.
נסמן לכל $0 \le t \in \ZZ$ את $Z_t$ מספר המחיידקים החיים באוכלוסיה בדור $t$.

\subquestion{}
יהי $t \in \NN$ ו־$z \ge 0$, נחשב את ההתפלגות $Z_t \mid \{ Z_{t - 1} = z \}$ ונסיק $\EE(Z_t \mid \{Z_{t - 1} = z\}) = z c$.
\begin{proof}
	למעשה, נתון כי ישנם $z$ חיידקים, כל אחד מהם מתפלג פואסונית, וראינו בהרצאה שחיבור של משתנים מקריים בלתי־תלויים פואסון מתפלג פואסון בחיבור הפרמטרים שלהם, לכן נובע ישירות
	\[
		Z_t \mid Z_{t - 1} \sim Poi(z c)
	\]
	נבחין כי אפשר להוכיח את הטענה פורמלית על־ידי יצירת וקטור מקרי של משתנים מתפלגים פואסונית ולהשתמש בחיבורם ובמסקנה מההרצאה באינדוקציה.

	מעוד תוצאה מההרצאה נובע
	\[
		\EE(Z_t \mid Z_{t - 1} = z) = z c
	\]
\end{proof}

\subquestion{}
נסיק $\EE(Z_t) = c^t$.
\begin{proof}
	נוכיח את הטענה באינדוקציה על $t$. \\
	כבסיס האינדוקציה נתון כי $\EE(Z_0) = c$ (מנוסחת תוחלת התפלגות פואסון והנתון). \\
	נניח כי הטענה נכונה עבור $t - 1$ ולכן $\EE(Z_{t - 1}) = c^{t - 1}$, וכן מנוסחת התוחלת השלמה
	\[
		\EE(Z_t)
		= \sum_{z = 1}^{\infty} \EE(Z_t \mid Z_{t - 1} = z) \PP(Z_{t - 1} = z)
		= c \sum_{z = 1}^{\infty} z \PP(Z_{t - 1} = z)
		= c \cdot c^{t - 1}
		= c^t
	\]
	והשלמנו את מהלך האינדוקציה.
\end{proof}

\subquestion{}
נאמר שהאוכלוסיה נכחדה אם קיים $t$ עבורו $Z_t = 0$. \\
נניח כי $c < 1$ ונוכיח שההסתברות שאוכלוסיית החיידקים תיכחד היא $1$.
\begin{proof}
	%אנו מחפשים את $\PP(\forall t \ge 0, Z_t = 0) = \sum_{n = 0}^{\infty} \PP(Z_t = 0)$.
	\[
		\PP(Z_t = 0)
		= 1 - \PP(Z_t \ge 1)
		\ge 1 - \frac{\EE(Z_t)}{1}
		= 1 - c^t
	\]
	ולכן $\PP(Z_t = 0) \xrightarrow[t \to \infty]{} 1$. \\
	אנו מחפשים את הסיכוי שעבור איזשהו $t$ האוכלוסייה תיכחד ולכן עלינו להגדיר $Z = \min\{Z_i \mid i \in \NN \cup \{0\}\}$, וכמובן מהערך שמצאנו בהכרח $\PP(Z = 0) = 1$.
\end{proof}

\question{}
1000 אנשים מגיעים למעבדה להיבדק למחלה, ההסתברות שאדם חולה היא $p$ באופן בלתי־תלוי. \\
מחלקים את האנשים לקבוצות של 20, $A_1, \dots, A_{50}$.
בשלב הראשון בודקים בבדיקה יחידה אם לפחות אחד האנשים חולה בקבוצה, לכל קבוצה, ובשלב השני בודקים כל אדם בנפרד בקבוצות בהן היו חולים.

\subquestion{}
נבטא באמצעות $p$ את תוחלת מספר הבדיקות שהמעבדה מבצעת.
נמצא עבור אילו ערכי $p$ תוחלת מספר הבדיקות גדולה מ־1000.
\begin{solution}
	כל אדם חולה בהתפלגות ברנולי $p$, ולכן התפלגות החולים בקבוצה $A_i$ היא $Bin(20, p)$. \\
	נבחין כי הקבוצה תיבדק בשלב השני אם ורק אם יש לפחות אדם חולה אחד, כלומר $\PP(X_i > 0) = 1 - \PP(X_i = 0)$ כאשר $X_i \sim Bin(20, p)$, ולכן הקבוצה תיבדק בבודדים בהתפלגות ברנולי $1 - {(1 - p)}^{20}$. \\
	יש 50 קבוצות בלתי־תלויות וכל אחת נבדקת ביחידים בהתפלגות ברנולי, ולכן שוב ההתפלגות המשותפת היא בינומית, מספר הבדיקות בשלב השני, ונוסיף את 50 הבדיקות הקבוצתיות מההתחלה, מתקבל
	\[
		X = 50 + 20 \cdot Bin(50, 1 - {(1 - p)}^{20})
	\]
	כאשר $X$ מייצג את מספר הבדיקות, וכאשר עשינו שימוש בסימון לא סטנדרטי כדי להבהיר את ההתבססות של $X$ על התפלגות בינומית, זאת לצורך החישוב הבא. \\
	כדי לחשב את התוחלת נשתמש בלינאריות התוחלת ותוחלת הערך הקבוע, יחד עם תוחלת בינומית,
	\[
		\EE(X)
		= 50 + 20 \cdot \EE(Bin(50, 1 - {(1 - p)}^{20}))
		= 50 + 20 \cdot 50 \cdot (1 - {(1 - p)}^{20})
	\]

	נבדוק מתי $\EE(X) > 1000$,
	\[
		\EE(X) > 1000
		\iff 1 - {(1 - p)}^{20} > 0.95
		\iff 0.05 > {(1 - p)}^{20}
		\iff \sqrt[20]{0.05} > 1 - p
		\iff p > 1 - \sqrt[20]{0.05}
	\]
	ולכן עבור בערך $p > 0.139$ התוחלת תהיה גדולה מ־1000, כלומר אם אחוז החולים באוכלוסייה גדול מכ־13.9, אז לא משתלם להשתמש בשיטת הבדיקה הזו, ועדיף לחלק לקבוצות בגדלים שונים או לעבור לאסטרטגיית בדיקה אחרת.
\end{solution}

\subquestion{}
המעבדה מבצעת את 50 הבדיקות הראשונות הסדר מקרי אחיד, ולאחר מכן מבצעת את הבדיקות הבודדות גם כן בסדר מקרי אחיד. \\
נסמן ב־$Z$ את מספר הבדיקות שהמעבדה מבצעת עד שיש תוצאה לנבדק נתון, ונחשב את התוחלת של $Z$ על־ידי $p$.
\begin{solution}
	נחלק למקרים ואז נשתמש בנוסחת התוחלת השלמה. \\
	נניח שהנבדק הנתון לא חולה, ובמקרה זה או שהקבוצה שלו חולה או שהקבוצה שלו לא חולה. \\
	אם הקבוצה שלו לא חולה, אז ההתפלגות של הבדיקות שייעשו עד שהוא יקבל תשובה היא $U([50])$, זאת שכן הקבוצה שלו תיבדק בסדר מקרי אחיד ותקבל תשובה שלילית. \\
	נניח שהקבוצה שלו חולה ושהיו $k$ קבוצות חולות, אז ייעשו בכולל $50 + 20 \cdot k$ בדיקות, כאשר ההתפלגות היא אחידה על $20 \cdot k$ הבדיקות האחרונות. \\
	נעבור למצב בו הנבדק חולה, במקרה זה די שנדע את מספר הקבוצות החולות הכולל $k$ ולכן ההתפלגות תהיה תוספת של 50 להתפלגות אחידה על $20 \cdot k$. \\
	נסמן $A$ המאורע שהנבדק הנתון חולה ולכן
	\begin{align*}
		\EE(Z)
		& = \EE(Z \mid A) \PP(A) + \EE(Z \mid A^C) \PP(A^C) \\
		& = \EE(Z \mid A) p + \EE(Z \mid A^C) (1 - p)
	\end{align*}
	אנו יודעים שיש התפלגות אחידה על מספר הבדיקה עבור $Z \mid A$, ולכן די שנחשב על תוחלת מספר הבדיקות, כלומר על $\EE(X \mid A)$, מספר זה הוא $70 + 20 \cdot 49 (1 - {(1 - p)}^{19})$ ולכן
	\[
		\EE(Z \mid A)
		= 70 + 10 \cdot 49 (1 - {(1 - p)}^{19})
	\]
	נעבור לחישוב $\EE(Z \mid A^C)$, נסמן $Y$ המאורע שהקבוצה של הנבדק מכילה חולים, ולכן
	\[
		\EE(Z \mid A^C)
		= \EE(Z \mid A^C, Y) \PP(Y) + \EE(Z \mid A^C, Y^C) \PP(Y^C)
		= \EE(Z \mid A^C, Y) (1 - {(1 - p)}^{20}) + \EE(Z \mid A^C, Y^C) {(1 - p)}^{20}
	\]
	עבור $\EE(Z \mid A^C, Y)$ זהו המקרה שהקבוצה חולה ולכן $\EE(Z \mid A^C, Y) = 70 + 10 \cdot 49 (1 - {(1 - p)}^{19})$ שכן זהו המקרה שיש חולים בקבוצה, והיא תיבדק מחדש.
	עבור $\EE(Z \mid A^C, Y^C) = \EE(Z \mid Y^C)$ ולכן $\EE(Z \mid Y^C) = \frac{21}{2}$ שכן זהו המקרה שבו הנבדק מקבל תשובה כבר בהתחלה.
	לכן
	\[
		\EE(Z \mid A^C)
		= (70 + 10 \cdot 49 (1 - {(1 - p)}^{19})) (1 - {(1 - p)}^{20}) + \frac{21}{2} {(1 - p)}^{20}
	\]
	וכן
	\begin{align*}
		\EE(Z)
		& = \EE(Z \mid A) p + \EE(Z \mid A^C) (1 - p) \\
		& = (70 + 10 \cdot 49 (1 - {(1 - p)}^{19})) p + ((70 + 10 \cdot 49 (1 - {(1 - p)}^{19})) (1 - {(1 - p)}^{20}) + \frac{21}{2} {(1 - p)}^{20}
) (1 - p)
	\end{align*}
\end{solution}

\subquestion{}
נקבע עבור $p = 0.01, 0.1, 0.5$ מה האיגום הטוב ביותר מבחינת מזעור כמות הבדיקות בחלוקה לקבוצות של $5, 10, 50$ אנשים.
\begin{solution}
	אם $x$ מייצג את כמות האנשים בקבוצה אז נגדיר $X_x^p$ מספר הבדיקות הכללי שיש לבצע בחלוקה לקבוצות של $x$ אנשים.
	\[
		\EE(X_x^p)
		= \frac{1000}{x} + 1000(1 - {(1 - p)}^x)
		= 1000(\frac{1}{x} + 1 - {(1 - p)}^x)
	\]
	ובהתאם
	\[
		\EE(X_5^{0.01}) \approx 249,
		\qquad \EE(X_{10}^{0.01}) \approx 195.6,
		\qquad \EE(X_{50}^{0.01}) \approx 414
	\]
	והכי ישתלם לבחור קבוצות של 10 אנשים. \\
	באופן דומה גם
	\[
		\EE(X_5^{0.1}) \approx 609.5,
		\qquad \EE(X_{10}^{0.1}) \approx 751.3,
		\qquad \EE(X_{50}^{0.1}) \approx 1014.8
	\]
	ולכן נבחר לחלק את האנשים לקבוצות של 5. \\
	לבסוף גם
	\[
		\EE(X_5^{0.5}) \approx 1168.7,
		\qquad \EE(X_{10}^{0.5}) \approx 1099,
		\qquad \EE(X_{50}^{0.5}) = 1020
	\]
	ולכן נבחר קבוצות של 50 אנשים.
\end{solution}

\question{}
יהיו $X, Y$ משתנים מקריים בעלי שונות המקיימים $\var(X) = \var(Y)$ ונוכיח ש־$X - Y, X + Y$ הם משתנים מקריים בלתי־מתואמים.
\begin{proof}
	\begin{align*}
		\cov(X - Y, X + Y)
		& = \cov(X, X + Y) - \cov(Y, X + Y) \\
		& = \cov(X, X) + \cov(X, Y) - \cov(Y, X) - \cov(Y, Y) \\
		& = \cov(X, X) - \cov(Y, Y) \\
		& = \var(X) - \var(Y) \\
		& = 0
	\end{align*}
	כאשר המעברים נבעו מלינאריות, קומוטטיביות, הזהות $\var(X) = \cov(X, X)$ והנתון.
\end{proof}

\question{}
יהי $X \sim U(\{-n, \dots, n\})$ עבור $n \in \NN$ ותהי $f : \RR \to \RR$ פונקציה זוגית. \\
נוכיח ש־$X, f(X)$ הם משתנים מקריים בלתי־מתואמים.
\begin{proof}
	נתחיל בחישוב,
	\[
		\EE(X)
		= \sum_{m = -n}^{n} m \PP(X = m)
		= 0 \cdot \PP(X = 0) + \sum_{m = 1}^{n} m \PP(X = m) + \sum_{m = 1}^{n} -m \PP(X = -m)
		= \sum_{m = 1}^{n} m \frac{1}{2n + 1} - m \frac{1}{2n + 1}
		= 0
	\]
	ולכן
	\begin{align*}
		\cov(X, f(X))
		& = \EE((X - \EE(X))(f(X) - \EE(f(X)))) \\
		& = \EE(X f(X) - X \EE(f(X)))
		= \EE(X f(X)) - \EE(X) \EE(f(X))
		= \EE(X f(X))
	\end{align*}
	נבחין כי $X$ מתפלגת סימטרית וגם $f(X)$ ולכן גם $X f(X)$, זאת אומרת $\PP(X f(X) = n) = \PP(X f(X) = -n)$, ולכן
	\[
		\EE(X f(X))
		= \sum_{s \in \Supp X f(X)} s \PP(X f(X) = s)
		= \sum_{s > 0 \in \Supp X f(X)} s \PP(X f(X) = s)
		+ \sum_{s > 0 \in \Supp X f(X)} -s \PP(X f(X) = -s)
		= 0
	\]
	ובהתאם $\cov(X, f(X)) = 0$ כפי שרצינו להראות.
\end{proof}

\question{}
יהיו $X, Y$ משתנים מקריים בלתי־תלויים כך שמתקיים
\[
	\var(X) = \var(Y) = \EE(X) = \EE(Y)
\]

\subquestion{}
נחשב את התוחלת והשונות של $X + Y$.
\begin{solution}
	מלינאריות התוחלת
	\[
		\EE(X + Y) = \EE(X) + \EE(Y) = 1 + 1 = 2
	\]
	וכן מתוצאה מההרצאה ומאי־התלות הגורר אי־תיאום נובע גם
	\[
		\var(X + Y) = \var(X) + \var(Y) = 2
	\]
\end{solution}

\subquestion{}
נחשב את התוחלת והשונות של $XY$.
\begin{solution}
	מאי־התלות של $X, Y$ נסיק
	\[
		\EE(XY)
		= \EE(X) \cdot \EE(Y)
		= 1
	\]
	נעבור לחישוב השונות.
	נבחין כי
	\[
		1 = \var(X)
		= \EE({(X - \EE(X))}^2)
		= \EE({(X - 1)}^2)
		= \EE(X^2) - 2 \EE(X) + 1
		= \EE(X^2) - 1
	\]
	ולכן $\EE(X^2) = 2$, ובאופן דומה גם $\EE(Y^2) = 2$.
	מההגדרה השקולה לשונות
	\[
		\var(XY)
		= \EE({(XY)}^2) - {(\EE(XY))}^2
		= \EE(X^2 Y^2) - 1^2
		= \EE(X^2) \EE(Y^2) - 1
		= 3
	\]
\end{solution}

\end{document}
